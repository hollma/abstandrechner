<!doctype html>
<html>
    <head>
<script type='text/javascript' charset='UTF-8'  src='https://cdnjs.cloudflare.com/ajax/libs/jsxgraph/0.99.7/jsxgraphcore.js'></script>
<link rel='stylesheet' type='text/css' href='//cdnjs.cloudflare.com/ajax/libs/jsxgraph/0.99.7/jsxgraph.css' />
     </head>
    <body>

	<div id='jxgbox' class='jxgbox' style='width:1920px; height:1080px;'></div>
	<script type='text/javascript'>

	// todo: see below; 
	// todo: calculate and show distances in a div-box at the top left
	// todo: better attractors (stick all points to the lines)

	// initialize coordinate system
	var board = JXG.JSXGraph.initBoard('jxgbox', {boundingbox: [0, 100, 100, 0],keepaspectratio: true});

	// todo: load image from local storage or external URL without uploading the image
	var urlImg = 'https://wiki.fricklers.org/lib/exe/fetch.php/abstand/2018-10-05_alltagserlebnisse_17_43_4.jpg.jpg';

	// set background image
	// todo: determine size of the image automatically (not fixed 192:108 ratio as in FullHD)
	var im = board.create('image',[urlImg, [0,0], [192,108] ], {fixed : true});
	
	// initialize points
	var F  = board.create('point',[108,82], {name:'F',size:4}); // vanishing point
	var S  = board.create('point',[40,35], {name:'S',size:4, attractors : [srtrack], attractorDistance:0.2, snatchDistance: 5}); // left lane
	var R  = board.create('point',[125,35], {name:'R',size:4, attractors : [srtrack], attractorDistance:0.2, snatchDistance: 5}); // right lane

	// todo: determine middle of the image automatically
	var midbot  = board.create('point',[96,0], {name:'M', size:4, fixed:true}); // camera position 
	
	// aux lines (perspective)
	var ltrack = board.create('line',['F', 'S'], {strokeColor:'#ffffff',strokeWidth:2});
	var rtrack = board.create('line',['F', 'R'], {strokeColor:'#0000ff',strokeWidth:2});

	// horizontal aux lines
	var srtrack = board.create('line',[[40,35], [125,35]], {name : 'srtrack', strokeColor:'#ff00ff',strokeWidth:2});	
	var srtrackcopy = board.create('line',[[70, 56],[117.5, 56] ], {withLabel:false});

	// more aux points for car position (A) and camera projection (K)
	var A  = board.create('point',[83,35], {name:'A',size:4, attractors : [srtrack], attractorDistance:0.2, snatchDistance: 5});

	// aux lines (perspective)
	var ktrack = board.create('line',['F', 'M'], {strokeColor:'#00ff00',strokeWidth:2});
	var atrack = board.create('line',['F', 'A'], {strokeColor:'#ff0000',strokeWidth:2});

	// aux points (copies)
	var i = board.create('intersection', [ltrack, srtrackcopy, 0], {name : 'S\''});
	var i = board.create('intersection', [rtrack, srtrackcopy, 0], {name : 'R\''});
	var i = board.create('intersection', [ktrack, srtrackcopy, 0], {name : 'K\''});
	var i = board.create('intersection', [atrack, srtrackcopy, 0], {name : 'A\''});

	// copy of car position and camera projection points
	var K  = board.create('intersection',[ktrack, srtrack, 0], {name:'K'});

	</script>
</html>
